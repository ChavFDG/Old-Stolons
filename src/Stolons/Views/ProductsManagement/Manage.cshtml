@model Stolons.ViewModels.ProductsManagement.ProductEditionViewModel
@using Stolons.Helpers

@{
    if (Model.IsNew)
    {
        ViewData["Title"] = "Ajouter un produit";
    }
    else
    {
        ViewData["Title"] = "Edition du produit";
    }
}

<h2>@ViewData["Title"]</h2>

<form asp-action="Create" enctype="multipart/form-data">
    <div class="form-horizontal">
        <hr />
        <div asp-validation-summary="ValidationSummary.All" class="text-danger"></div>
        <div class="form-group">
            <label asp-for="Product.Name" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.Name" class="form-control" />
                <span asp-validation-for="Product.Name" class="text-danger" />
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Product.Description" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <textarea rows="5" asp-for="Product.Description" class="form-control"></textarea>
                <span asp-validation-for="Product.Description" class="text-danger" />
            </div>
        </div>
        <div class="form-group" >
            <label asp-for="Product.Labels" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                @foreach (Product.Label label in Enum.GetValues(typeof(Product.Label)))
                {
                    <span>
                        @(EnumHelper<Product.Label>.GetDisplayValue(label))
                        @if (Model.SelectedLabels.Contains(label.ToString()))
                        {
                            <input type="checkbox"  name="SelectedLabels" value="@label.ToString()" id="@label.ToString()" checked>
                        }
                        else
                        {
                            <input type="checkbox"  name="SelectedLabels" value="@label.ToString()" id="@label.ToString()">
                        }
                    </span>
                    <br/>
                }
            </div>
        </div>
        <div class="form-group">
            <label class="col-md-2 control-label">Photo principale</label>
            <div class="col-md-10">
                <input type="file" accept="image/*" name="UploadFile1" class="form-control" />
            </div>
        </div>
        <div class="form-group">
            <label class="col-md-2 control-label">2ieme photo</label>
            <div class="col-md-10">
                <input type="file" accept="image/*" name="UploadFile2" class="form-control" />
            </div>
        </div>
        <div class="form-group">
            <label class="col-md-2 control-label">3ieme photo</label>
            <div class="col-md-10">
                <input type="file" accept="image/*" name="UploadFile3" class="form-control" />
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Product.DLC" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.DLC" class="form-control" />
                <span asp-validation-for="Product.DLC" class="text-danger" />
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Product.Familly" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <select asp-for="FamillyName" class="form-control">
                    @foreach (var productType in Model.ProductTypes)
                    {
                        <optgroup label="@productType.Name">
                            @foreach (var productFamily in productType.ProductFamilly)
                            {
                                <option value="@productFamily.FamillyName">@productFamily.FamillyName</option>
                            }
                        </optgroup>
                    }
                </select>
            </div>
        </div>
        <script>
            $('#SellType').change(function () {
                if ($("#SellType").val() == 1)
                    $("#AverageQuantityDiv").show();
                else
                    $("#AverageQuantityDiv").hide();
            });
        </script>
        <div class="form-group">
            <label asp-for="Product.Type" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <select id="SellType" asp-for="Product.Type" asp-items="Html.GetEnumSelectList<Product.SellType>()" class="form-control"></select>
                <span asp-validation-for="Product.Type" class="text-danger" />
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Product.ProductUnit" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <select asp-for="Product.ProductUnit" asp-items="Html.GetEnumSelectList<Product.Unit>()" class="form-control"></select>
                <span asp-validation-for="Product.ProductUnit" class="text-danger" />
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Product.QuantityStep" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input  asp-for="Product.QuantityStep" class="form-control" />
                <span asp-validation-for="Product.QuantityStep" class="text-danger" />
            </div>
        </div>
        <div class="form-group" id="AverageQuantityDiv">
            <label asp-for="Product.AverageQuantity" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.AverageQuantity" class="form-control" />
                <span asp-validation-for="Product.AverageQuantity" class="text-danger" />
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Product.Price" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.Price" class="form-control" />
                <span asp-validation-for="Product.Price" class="text-danger" />
            </div>
        </div>
        <!--HIDDEN-->
        <div class="form-group" hidden="hidden">
            <label asp-for="Product.Id" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.Id" class="form-control" />
            </div>
        </div>
        <div class="form-group" hidden="hidden">
            <label asp-for="Product.PicturesSerialized" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.PicturesSerialized" class="form-control" />
            </div>
        </div>
        <div class="form-group" hidden="hidden">
            <label asp-for="Product.RemainingStock" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.RemainingStock" class="form-control" />
            </div>
        </div>
        <div class="form-group" hidden="hidden">
            <label asp-for="Product.WeekStock" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Product.WeekStock" class="form-control" />
            </div>
        </div>
        <div class="form-group" hidden="hidden">
            <label asp-for="Product.State" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <select asp-for="Product.State" asp-items="Html.GetEnumSelectList<Product.ProductState>()" class="form-control"></select>
            </div>
        </div>
        <div class="form-group"  hidden="hidden" >
            <label asp-for="IsNew" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="IsNew"  class="form-control"/>
            </div>
        </div>

        <!--Submit-->
        @if (Model.IsNew)
        {
            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Ajouter" class="btn btn-default" />
                </div>
            </div>
        }
        else
        {
            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Editer" class="btn btn-default" />
                </div>
            </div>
        }
    </div>
</form>

<div>
    <a asp-action="Index">Revenir aux produits</a>
</div>

@section Scripts {
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
}
